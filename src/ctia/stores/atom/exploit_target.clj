(ns ctia.stores.atom.exploit-target
  (:require [ctia.schemas.exploit-target
             :refer [NewExploitTarget StoredExploitTarget realize-exploit-target]]
            [ctia.stores.atom.common :as mc]))

(def swap-exploit-target (mc/make-swap-fn realize-exploit-target))

(mc/def-create-handler handle-create-exploit-target
  StoredExploitTarget NewExploitTarget swap-exploit-target (mc/random-id "exploit-target"))

(mc/def-read-handler handle-read-exploit-target StoredExploitTarget)

(mc/def-delete-handler handle-delete-exploit-target StoredExploitTarget)

(mc/def-update-handler handle-update-exploit-target
  StoredExploitTarget NewExploitTarget swap-exploit-target)
